# GGEBiplots_G2F
Authors: Elliot Braun, Eleanor Carr & Joseph Ulasi  
The goal of this project was to extend genotype-by-environment (GxE) analyses performed by Falcon et al. (2019) and Lopez-Cruz et al. (2023) on data provided by the Genomes-to-Fields initiative (G2F). We aimed to classify environments, as defined by a combination of year and location, by their ability to discriminate genotypes. We then characterized those differences using environmental covariates generated by an APSIM crop growth model. We found that soil water was significantly different between high- and low-discriminability environments. The provided code outlines a procedure for taking the curated dataset of G2F phenotypes & genotypes and set of environmental covariates provided by Lopez-Cruz et al. (2023) and analyzing the environments using the R package `GGEBiplots`.

## Procedure
1. Generate a `GGEModel()` input file from provided phenotypes & genotypes
    a. `GGEModel()` requires a file with genotypes as rows and environments as columns, where each genotype x environment condition is represented by a single value. There should be no missing data.
2. Make a `GGEBiplot` using `GGEPlot()` and use it to extract discriminability scores
3. Create a list of high- and low-discriminability environments
4. Group the environmental covariates into independent groups
5. Perform a t-test to evaluate the significance of differences in environmental covariates between the two groups
6. Perform false discovery rate correction to generate FDR-corrected p-values
7. Generate plots to assess and evaluate your analysis

## Data
All data from Lopez-Cruz et al. (2023) can be found at https://github.com/QuantGen/MAIZE-HUB, but the files used to generate this code are provided in `data` for your convenience. The list of checks was downloaded from the Genomes-to-Fields website: https://www.genomes2fields.org/about/project-overview/#YS-HIP_Hybrid-HIP_Inbred-genotypes.